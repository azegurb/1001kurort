import HtmlToReact from 'html-to-react';
import React from 'react';
import { render } from 'react-dom';
import ReactStage from './index';
import DomToString from './utilities/dom-to-string';

const HtmlToReactParser = new HtmlToReact.Parser();

const initialize = (selector = '.react-stage', settings = {}) => {
  const stages = document.querySelectorAll(selector);
  stages.forEach((stage) => {
    const children = Array.prototype.slice.call(stage.children).map(
      (child) => HtmlToReactParser.parse(DomToString(child)));
    render(<ReactStage {...settings}>{children}</ReactStage>, stage);
  });
};

initialize();

module.exports = { initialize };
