/* eslint-disable no-console */
import express from 'express';
import React from 'react';
import { renderToString } from 'react-dom/server';
import Helmet from 'react-helmet';
import Html from './components/layouts/Html';
import App from './components/pages/App';

const app = express();

app.use('/assets/lib', express.static('./lib', { fallthrough: false }));
app.use('/assets', express.static('./build/assets', { fallthrough: false }));

app.get('/', (request, response) => {
  const content = renderToString(<App />);
  const head = Helmet.renderStatic();
  response.send(`<!DOCTYPE html>${renderToString(<Html head={head} content={content} />)}`);
});

app.listen(process.env.PORT || 3000, () => {
  if (!process.env.NODEMON_STATUS) {
    console.log(`Demo application listening on port ${process.env.PORT || 3000}`);
  }
});
